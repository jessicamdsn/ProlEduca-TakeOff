<!-- BOTÃO FILTRAR (MOBILE) -->
<div
  class="d-lg-none w-100 d-flex justify-content-between align-items-center px-3 mb-3 gap-4"
>
  <button
    class="btn botao-filtro-mobile"
    data-bs-toggle="modal"
    data-bs-target="#filtroModal"
  >
    Filtrar
  </button>

  <div class="d-flex justify-content-end" *ngIf="bolsasFiltradas && bolsasFiltradas.length > 0">
    <button class="btn btn-orden" (click)="ordenarPorPreco()">
      Ordenar por preço
      <i
        class="bi"
        [ngClass]="ordemPrecoAsc ? 'bi-arrow-down' : 'bi-arrow-up'"
      ></i>
    </button>
  </div>
</div>

<div class="d-flex justify-content-lg-around flex-column flex-lg-row">
  <!-- FILTROS (DESKTOP) -->
  <div
    class="filtros-container p-4 rounded shadow-sm bg-white d-none d-lg-block"
    style="height: 625px"
  >
    <h5 class="mb-4 fw-bold fs-6">Filtre os Resultados</h5>

    <div class="mb-3">
      <label class="form-label">Qual instituição?</label>
      <select
        class="form-select"
        [(ngModel)]="filtros.instituicao"
        (change)="filtrarBolsas()"
      >
        <option value="">Todas</option>
        <option *ngFor="let inst of instituicoes" [value]="inst">
          {{ inst }}
        </option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Estado?</label>
      <select
        class="form-select"
        [(ngModel)]="filtros.estado"
        (change)="filtrarBolsas()"
      >
        <option value="">Todos</option>
        <option *ngFor="let est of estados" [value]="est">{{ est }}</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Cidade?</label>
      <select
        class="form-select"
        [(ngModel)]="filtros.cidade"
        (change)="filtrarBolsas()"
      >
        <option value="">Todas</option>
        <option *ngFor="let cid of cidade" [value]="cid">{{ cid }}</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Bairro?</label>
      <select
        class="form-select"
        [(ngModel)]="filtros.bairro"
        (change)="filtrarBolsas()"
      >
        <option value="">Todos</option>
        <option *ngFor="let b of bairro" [value]="b">{{ b }}</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Curso?</label>
      <select
        class="form-select"
        [(ngModel)]="filtros.curso"
        (change)="filtrarBolsas()"
      >
        <option value="">Todos</option>
        <option *ngFor="let c of cursos" [value]="c">{{ c }}</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Turno?</label>
      <div
        class="form-check"
        *ngFor="let turno of ['Manhã', 'Tarde', 'Noite', 'Integral']"
      >
        <input
          class="form-check-input"
          type="checkbox"
          [(ngModel)]="turnoSelecionado[turno]"
          (change)="toggleTurno(turnoSelecionado[turno], turno)"
        />
        <label class="form-check-label">{{ turno }}</label>
      </div>
    </div>
  </div>

  <!-- MODAL DE FILTROS (MOBILE) -->
  <div
    class="modal fade"
    id="filtroModal"
    tabindex="-1"
    aria-labelledby="filtroModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-3">
        <div class="modal-header">
          <h5 class="modal-title" id="filtroModalLabel">Filtrar Resultados</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Fechar"
          ></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Qual instituição?</label>
            <select
              class="form-select"
              [(ngModel)]="filtros.instituicao"
              (change)="filtrarBolsas()"
            >
              <option value="">Todas</option>
              <option *ngFor="let inst of instituicoes" [value]="inst">
                {{ inst }}
              </option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Estado?</label>
            <select
              class="form-select"
              [(ngModel)]="filtros.estado"
              (change)="filtrarBolsas()"
            >
              <option value="">Todos</option>
              <option *ngFor="let est of estados" [value]="est">
                {{ est }}
              </option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Cidade?</label>
            <select
              class="form-select"
              [(ngModel)]="filtros.cidade"
              (change)="filtrarBolsas()"
            >
              <option value="">Todas</option>
              <option *ngFor="let cid of cidade" [value]="cid">
                {{ cid }}
              </option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Bairro?</label>
            <select
              class="form-select"
              [(ngModel)]="filtros.bairro"
              (change)="filtrarBolsas()"
            >
              <option value="">Todos</option>
              <option *ngFor="let b of bairro" [value]="b">{{ b }}</option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Curso?</label>
            <select
              class="form-select"
              [(ngModel)]="filtros.curso"
              (change)="filtrarBolsas()"
            >
              <option value="">Todos</option>
              <option *ngFor="let c of cursos" [value]="c">{{ c }}</option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Turno?</label>
            <div
              class="form-check"
              *ngFor="let turno of ['Manhã', 'Tarde', 'Noite', 'Integral']"
            >
              <input
                class="form-check-input"
                type="checkbox"
                [(ngModel)]="turnoSelecionado[turno]"
                (change)="toggleTurno(turnoSelecionado[turno], turno)"
              />
              <label class="form-check-label">{{ turno }}</label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            class="btn btn-primary w-100"
            data-bs-dismiss="modal"
            (click)="filtrarBolsas()"
          >
            Aplicar filtros
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="no-results-container" *ngIf="bolsasFiltradas && bolsasFiltradas.length === 0">
    <p class="no-results-text text-muted">
      Nenhuma bolsa encontrada com os filtros selecionados.
    </p>
    <button class="btn btn-outline-primary" (click)="limparFiltros()">
      Limpar filtros
    </button>
  </div>

  <div class="container-card-bolsas">
    <div
      class="d-flex justify-content-end mb-1"
      *ngIf="bolsasFiltradas && bolsasFiltradas.length > 0"
    >
      <button class="btn btn-orden-normal mb-3" (click)="ordenarPorPreco()">
        Ordenar por preço
        <i
          class="bi"
          [ngClass]="ordemPrecoAsc ? 'bi-arrow-down' : 'bi-arrow-up'"
        ></i>
      </button>
    </div>

    <div *ngFor="let bolsa of bolsasPaginadas">
      <div class="container-card">
        <div class="container-img">
          <img
            style="width: 100px"
            class="d-flex justify-content-center"
            [src]="bolsa.logo"
            alt="{{ bolsa.alt }}"
          />
        </div>
        <div class="box-info">
          <div class="container-title-bolsas">
            <strong
              >{{ bolsa.serie }} - {{ bolsa.curso }} -
              {{ bolsa.modalidade }}</strong
            >
            <p>{{ bolsa.instituicao }}</p>
          </div>
          <div class="discount rounded-pill">
            <p class="p-2 d-flex justify-content-center">
              Bolsa de {{ bolsa.desconto || "50" }}%
            </p>
          </div>
          <p class="color fw-bold text-decoration-line-through fs-6">
            R${{ bolsa.precoOriginal  || "500,00" }}/mês
          </p>
          <p class="fs-6 fw-bold">R${{ bolsa.precoComDesconto }}/mês</p>
          <div class="info-bolsa d-flex flex-row text-secondary">
            <p>Ano da Bolsa: {{ bolsa.ano }}</p>
            <p>Campos: {{ bolsa.cidade }}</p>
            <p>Turno: {{ bolsa.turno }}</p>
          </div>
          <div class="btn-subcribe d-flex justify-content-center">
            <button style="width: 60%" class="rounded p-2">
              <a [routerLink]="['/cliente/cadastro']" class="text-decoration-none text-white" href="#"
                >Fazer inscrição</a
              >
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Paginação -->
    <nav
      *ngIf="bolsasFiltradas && bolsasFiltradas.length > 0"
      aria-label="Page navigation"
      class="mt-4 d-flex justify-content-center"
    >
      <ul class="pagination">
        <li class="page-item" [class.disabled]="paginaAtual === 1">
          <button
            class="page-link d-flex align-items-center gap-1"
            (click)="mudarPagina(paginaAtual - 1)"
          >
            <i class="bi bi-chevron-left"></i>
            <span>Anterior</span>
          </button>
        </li>

        <ng-container
          *ngFor="let pagina of [].constructor(totalPaginas); let i = index"
        >
          <li class="page-item" [class.active]="paginaAtual === i + 1">
            <button class="page-link" (click)="mudarPagina(i + 1)">
              {{ i + 1 }}
            </button>
          </li>
        </ng-container>

        <li class="page-item" [class.disabled]="paginaAtual === totalPaginas">
          <button
            class="page-link d-flex align-items-center gap-1"
            (click)="mudarPagina(paginaAtual + 1)"
          >
            <span>Próximo</span>
            <i class="bi bi-chevron-right"></i>
          </button>
        </li>
      </ul>
    </nav>
  </div>
</div>
